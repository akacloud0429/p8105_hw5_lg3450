p8105_hw5_lg3450
================

first load all necessary libraries

``` r
library(tidyverse)
```

# Problem 1

**Suppose you put n people in a room, and want to know the probability
that at least two people share a birthday. For simplicity, we’ll assume
there are no leap years (i.e. there are only 365 days) and that
birthdays are uniformly distributed over the year (which is actually not
the case).**

- Q1: Write a function that, for a fixed group size, randomly draws
  “birthdays” for each person; checks whether there are duplicate
  birthdays in the group; and returns TRUE or FALSE based on the result.

``` r
check_birthday = function(n) {
  #randomly draw #n birthdays from 1 to 365, allow for same bthd
  birthdays = sample(1:365, size = n, replace = TRUE)
  #logic: if length < n, duplication appears
  has_duplicate = length(unique(birthdays)) < n
  has_duplicate
}
```

- Q2: Next, run this function 10000 times for each group size between 2
  and 50. For each group size, compute the probability that at least two
  people in the group will share a birthday by averaging across the
  10000 simulation runs.

``` r
set.seed(1)

sim_grid = expand_grid(
  group_size = 2:50,
  iter = 1:10000)

sim_results = sim_grid |>
  mutate(
    has_duplicate = map_dbl(group_size, check_birthday))

prob_results = sim_results |>
  group_by(group_size) |>
  summarize(
    prob_shared = mean(has_duplicate))
prob_results
```

    ## # A tibble: 49 × 2
    ##    group_size prob_shared
    ##         <int>       <dbl>
    ##  1          2     0.00240
    ##  2          3     0.00850
    ##  3          4     0.0167 
    ##  4          5     0.0267 
    ##  5          6     0.0399 
    ##  6          7     0.0521 
    ##  7          8     0.0751 
    ##  8          9     0.0925 
    ##  9         10     0.116  
    ## 10         11     0.139  
    ## # ℹ 39 more rows

- Q3: Make a plot showing the probability as a function of group size,
  and comment on your results.
